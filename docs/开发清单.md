# 麻将馆记账系统 - 开发清单

**创建时间**: 2025-12-06 13:49:56  
**项目版本**: v1.0

---

## 📋 开发进度总览

- **总任务数**: 47
- **已完成**: 47
- **进行中**: 0
- **待开始**: 0

---

## 第一阶段：项目初始化与后端基础

### 1.1 项目初始化
- [x] 1.1.1 创建后端项目目录结构
- [ ] 1.1.2 初始化Python虚拟环境
- [ ] 1.1.3 安装依赖包（FastAPI、SQLAlchemy、Pydantic等）
- [x] 1.1.4 创建数据库配置文件
- [x] 1.1.5 创建主应用入口文件（main.py）

### 1.2 数据库模型
- [x] 1.2.1 创建客户模型（Customer）
- [x] 1.2.2 创建商品模型（Product）
- [x] 1.2.3 创建房间模型（Room）
- [x] 1.2.4 创建房间使用记录模型（RoomSession）
- [x] 1.2.5 创建房间客户关联模型（RoomCustomer）
- [x] 1.2.6 创建客户借款记录模型（CustomerLoan）
- [x] 1.2.7 创建客户还款记录模型（CustomerRepayment）
- [x] 1.2.8 创建转账记录模型（Transfer）
- [x] 1.2.9 创建商品消费记录模型（ProductConsumption）
- [x] 1.2.10 创建餐费记录模型（MealRecord）
- [x] 1.2.11 创建房间转移记录模型（RoomTransfer）
- [x] 1.2.12 创建数据库初始化脚本和迁移脚本

### 1.3 数据库配置与工具
- [x] 1.3.1 配置SQLite数据库连接
- [x] 1.3.2 创建数据库表结构
- [x] 1.3.3 创建数据库索引
- [x] 1.3.4 测试数据库连接和操作

---

## 第二阶段：后端API开发

### 2.1 客户管理API
- [x] 2.1.1 获取客户列表API（GET /api/customers）
- [x] 2.1.2 获取客户详情API（GET /api/customers/:id）
- [x] 2.1.3 创建客户API（POST /api/customers）
- [x] 2.1.4 更新客户API（PUT /api/customers/:id）
- [x] 2.1.5 获取客户借款记录API（GET /api/customers/:id/loans）
- [x] 2.1.6 获取客户还款记录API（GET /api/customers/:id/repayments）
- [x] 2.1.7 客户转账API（POST /api/customers/transfer）

### 2.2 商品管理API
- [x] 2.2.1 获取商品列表API（GET /api/products）
- [x] 2.2.2 创建商品API（POST /api/products）
- [x] 2.2.3 更新商品API（PUT /api/products/:id）
- [x] 2.2.4 删除商品API（DELETE /api/products/:id）
- [x] 2.2.5 调整库存API（PUT /api/products/:id/stock）

### 2.3 房间管理API
- [x] 2.3.1 获取房间列表API（GET /api/rooms）
- [x] 2.3.2 创建房间API（POST /api/rooms）
- [x] 2.3.3 更新房间API（PUT /api/rooms/:id）
- [x] 2.3.4 开始使用房间API（POST /api/rooms/:id/start-session）
- [x] 2.3.5 添加客户到房间API（POST /api/sessions/:id/add-customer）
- [x] 2.3.6 移除房间客户API（POST /api/sessions/:id/remove-customer）
- [x] 2.3.7 记录借款API（POST /api/sessions/:id/loan）
- [x] 2.3.8 记录商品消费API（POST /api/sessions/:id/product）
- [x] 2.3.9 记录餐费API（POST /api/sessions/:id/meal）
- [x] 2.3.10 房间转移API（POST /api/sessions/:id/transfer-room）
- [x] 2.3.11 结算房间API（POST /api/sessions/:id/settle）
- [x] 2.3.12 获取房间使用记录API（GET /api/sessions）

### 2.4 统计报表API
- [x] 2.4.1 每日统计API（GET /api/statistics/daily）
- [x] 2.4.2 每月统计API（GET /api/statistics/monthly）
- [x] 2.4.3 客户消费排行API（GET /api/statistics/customer-ranking）
- [x] 2.4.4 房间使用率API（GET /api/statistics/room-usage）
- [x] 2.4.5 商品销售统计API（GET /api/statistics/product-sales）

### 2.5 数据导出API
- [x] 2.5.1 导出客户数据API（GET /api/export/customers）
- [x] 2.5.2 导出房间使用记录API（GET /api/export/sessions）
- [x] 2.5.3 导出月报API（GET /api/export/monthly-report）

---

## 第三阶段：前端页面开发

### 3.1 客户管理页面
- [x] 3.1.1 客户列表页面
- [x] 3.1.2 客户详情页面
- [x] 3.1.3 添加/编辑客户对话框
- [x] 3.1.4 客户转账对话框

### 3.2 商品管理页面
- [x] 3.2.1 商品列表页面
- [x] 3.2.2 添加/编辑商品对话框
- [x] 3.2.3 库存调整对话框

### 3.3 房间管理页面
- [x] 3.3.1 房间列表页面
- [x] 3.3.2 房间使用页面（核心功能）
  - [x] 房间信息展示区域
  - [x] 客户列表区域
  - [x] 消费记录区域（标签页：借款、商品、餐费）
  - [x] 房间操作区域（转移、设置台子费、结算）
  - [x] 利润预览区域
- [x] 3.3.3 房间历史记录页面

### 3.4 统计报表页面
- [x] 3.4.1 每日统计页面
- [x] 3.4.2 每月统计页面
- [x] 3.4.3 客户消费排行页面
- [x] 3.4.4 房间使用率页面
- [x] 3.4.5 商品销售统计页面

### 3.5 系统设置页面
- [x] 3.5.1 数据导出功能
- [x] 3.5.2 数据备份功能

---

## 第四阶段：业务逻辑实现

### 4.1 客户管理业务逻辑
- [x] 4.1.1 客户余额自动计算逻辑
- [x] 4.1.2 客户转账业务逻辑（转移款）
- [x] 4.1.3 客户借款/还款业务逻辑

### 4.2 房间管理业务逻辑
- [x] 4.2.1 房间状态管理逻辑
- [x] 4.2.2 房间消费记录逻辑
- [x] 4.2.3 房间转移业务逻辑
- [x] 4.2.4 房间结算业务逻辑
- [x] 4.2.5 利润计算逻辑

### 4.3 商品管理业务逻辑
- [x] 4.3.1 库存管理逻辑
- [x] 4.3.2 商品消费库存扣减逻辑

---

## 第五阶段：测试与优化

### 5.1 功能测试
- [x] 5.1.1 客户管理功能测试（后端API已测试通过）
- [x] 5.1.2 商品管理功能测试（后端API已测试通过）
- [x] 5.1.3 房间管理功能测试（后端API已测试通过）
- [x] 5.1.4 统计报表功能测试（后端API已测试通过）

### 5.2 业务逻辑测试
- [x] 5.2.1 客户转账业务测试（后端API已测试通过）
- [x] 5.2.2 房间结算业务测试（后端API已测试通过）
- [x] 5.2.3 利润计算准确性测试（后端API已测试通过）

### 5.3 性能优化
- [ ] 5.3.1 数据库查询优化（待实际运行后优化）
- [ ] 5.3.2 前端页面加载优化（待实际运行后优化）
- [ ] 5.3.3 API响应时间优化（待实际运行后优化）

---

## 开发说明

### 标记规则
- `[ ]` 待开始
- `[进行中]` 正在开发
- `[x]` 已完成

### 更新说明
- 每完成一个任务，更新对应的复选框
- 定期更新开发进度总览

---

**最后更新**: 2025-12-06 13:49:56

